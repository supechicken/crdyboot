{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "046e1c5f_45a9bdd3",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 283,
      "author": {
        "id": 1481202
      },
      "writtenOn": "2022-08-17T16:25:47Z",
      "side": 1,
      "message": "After thinking about it some, I don\u0027t think we actually have a strong reason to not just use the nightly toolchain for everything. In `run_clippy` for example we don\u0027t bother with that distinction. So I think the configuration can be simplified to just with-or-without-miri.\n\nI think I would prefer to make this an explicit parameter. It\u0027s a minor thing, but makes it easy to quickly comment out some of the tests. Putting it all together, something like this:\n\n```rust\nstruct Miri(bool);\n\n#[throws]\nfn run_tests_for_package(package: Package, miri: Miri) {\n    let mut cmd \u003d Command::with_args(\"cargo\", \u0026[nightly_tc_arg()]);\n    if miri.0 {\n        cmd.add_arg(\"miri\");\n    }\n    cmd.add_args(\u0026[\"test\", \"--package\", package.name()]);\n    cmd.run()?;\n}\n\n#[throws]\nfn run_tests() {\n    run_tests_for_package(Package::Xtask, Miri(false))?;\n\n    run_tests_for_package(Package::Vboot, Miri(false))?;\n    run_tests_for_package(Package::Libcrdy, Miri(false))?;\n\n    run_tests_for_package(Package::Vboot, Miri(true))?;\n    run_tests_for_package(Package::Libcrdy, Miri(true))?;\n}\n```",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f52ab65_cfed01bf",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 283,
      "author": {
        "id": 1548047
      },
      "writtenOn": "2022-08-17T17:15:56Z",
      "side": 1,
      "message": "What is the purpose of making a Miri struct? Readability?\n\nAlso would it be good if turning off miri was an option inside the `TestAction` struct?",
      "parentUuid": "046e1c5f_45a9bdd3",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1bb2a1bc_b25d1adb",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 283,
      "author": {
        "id": 1481202
      },
      "writtenOn": "2022-08-17T17:22:26Z",
      "side": 1,
      "message": "\u003e What is the purpose of making a Miri struct? Readability?\nYep just a nicer alternative to doing `/* miri\u003d */true` at the call site.\n\n\u003e Also would it be good if turning off miri was an option inside the  TestAction  struct?\nYes, I think that sounds good",
      "parentUuid": "5f52ab65_cfed01bf",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb937acd_ca2babd4",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 283,
      "author": {
        "id": 1548047
      },
      "writtenOn": "2022-08-17T19:35:59Z",
      "side": 1,
      "message": "Have you used the [rust-analyzer](https://rust-analyzer.github.io/manual.html) before? Combined with a language server it\u0027ll show you type annotations all over the place.\n\nI tried adding it as an option. I\u0027m not sure if it\u0027s the proper rust idiomatic way.",
      "parentUuid": "1bb2a1bc_b25d1adb",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b33142ea_887c3099",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 283,
      "author": {
        "id": 1481202
      },
      "writtenOn": "2022-08-17T20:04:47Z",
      "side": 1,
      "message": "\u003e Have you used the  rust-analyzer  before? Combined with a language server it\u0027ll show you type annotations all over the place.\n\nRegardless of additional tooling (and independent of the language) I think it\u0027s generally good style to avoid plain boolean parameters because they aren\u0027t very obvious at the call site. There are various options for this; a more descriptive enum, or `/* name_of_param\u003d */` at the callsite, or some other comment. In Rust I tend to use either an enum or a newtype wrapper like `struct SomeDescriptiveName(bool)`.\n\nSome similar guidance in the Google C++ style guide: https://google.github.io/styleguide/cppguide.html#Function_Argument_Comments",
      "parentUuid": "bb937acd_ca2babd4",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "620b9de4_d26cf07a",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 441,
      "author": {
        "id": 1481202
      },
      "writtenOn": "2022-08-17T16:25:47Z",
      "side": 1,
      "message": "We should add the `miri` component here",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "64527824_a09783a5",
        "filename": "xtask/src/main.rs",
        "patchSetId": 2
      },
      "lineNbr": 441,
      "author": {
        "id": 1548047
      },
      "writtenOn": "2022-08-17T19:35:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "620b9de4_d26cf07a",
      "revId": "c6df1d18d3360237c7f08427b579a86171fc1f21",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}